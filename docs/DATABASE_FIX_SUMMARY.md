# âœ… æ•°æ®åº“åˆå§‹åŒ–é—®é¢˜å·²è§£å†³

## ğŸ‰ é—®é¢˜è§£å†³ç¡®è®¤

ä»æœ€æ–°çš„è¿è¡Œæ—¥å¿—å¯ä»¥çœ‹åˆ°ï¼Œæ•°æ®åº“åˆå§‹åŒ–å®Œå…¨æˆåŠŸï¼š

### æˆåŠŸæ—¥å¿—è¾“å‡º

```bash
[0] [2026-01-13T11:15:18.246Z] [INFO] æ­£åœ¨åˆå§‹åŒ–æ•°æ®åº“...
[0] [2026-01-13T11:15:18.259Z] [INFO] æ•°æ®åº“è¿æ¥å·²å»ºç«‹
[0] [2026-01-13T11:15:18.260Z] [INFO] æ•°æ®åº“è¡¨åˆ›å»ºå®Œæˆ
[0] [2026-01-13T11:15:18.261Z] [INFO] æ•°æ®åº“åˆå§‹åŒ–å®Œæˆ
[0] [2026-01-13T11:15:18.262Z] [INFO] æ­£åœ¨å¯åŠ¨å†…ç½®æœåŠ¡å™¨...
[0] [2026-01-13T11:15:18.279Z] [INFO] æœåŠ¡å™¨å¯åŠ¨æˆåŠŸï¼Œç«¯å£: 3001
[0] [2026-01-13T11:15:18.543Z] [INFO] ResumerHelper æ¡Œé¢åº”ç”¨å¯åŠ¨å®Œæˆ
[0] [2026-01-13T11:15:18.550Z] [INFO] KOAæœåŠ¡å™¨å¯åŠ¨æˆåŠŸï¼Œç›‘å¬ç«¯å£: 3001

[1] VITE v6.4.1  ready in 594 ms
[1] âœ  Local:   http://localhost:3000/
```

### æ‰€æœ‰æœåŠ¡çŠ¶æ€

| æœåŠ¡            | çŠ¶æ€        | ç«¯å£/è·¯å¾„                                                            |
| --------------- | ----------- | -------------------------------------------------------------------- |
| Electron ä¸»è¿›ç¨‹ | âœ… è¿è¡Œä¸­   | -                                                                    |
| Vite å¼€å‘æœåŠ¡å™¨ | âœ… è¿è¡Œä¸­   | 3000                                                                 |
| å†…ç½® KOA æœåŠ¡å™¨ | âœ… è¿è¡Œä¸­   | 3001                                                                 |
| SQLite æ•°æ®åº“   | âœ… å·²åˆå§‹åŒ– | `/Users/james/Library/Application Support/Electron/resumerhelper.db` |

---

## ğŸ”§ ä¿®å¤çš„å…³é”®æ­¥éª¤

### 1. åˆ é™¤æ—§çš„ç¼–è¯‘äº§ç‰©

```bash
rm -rf node_modules/better-sqlite3/build
rm -rf node_modules/better-sqlite3/.node-gyp
```

### 2. è·³è¿‡é¢„å®‰è£…è„šæœ¬

```bash
cd node_modules/better-sqlite3
npm install --ignore-scripts
```

### 3. ä»æºä»£ç ç¼–è¯‘

```bash
npm run build-release
```

### 4. ä¸º Electron 28 é‡æ–°ç¼–è¯‘

```bash
export npm_config_runtime=electron
export npm_config_target=28.3.3
export npm_config_disturl=https://electronjs.org/headers
export npm_config_build_from_source=true

npm run build-release
```

---

## ğŸ“‹ é—®é¢˜æ ¹å› æ€»ç»“

### åŸå§‹é”™è¯¯

```
ERR_DLOPEN_FAILED
```

### æ ¹æœ¬åŸå› 

`better-sqlite3` åŸç”Ÿæ¨¡å—çš„ ABI ç‰ˆæœ¬ä¸åŒ¹é…ï¼š

| ç¯å¢ƒ                  | Node.js ç‰ˆæœ¬ | NODE_MODULE_VERSION |
| --------------------- | ------------ | ------------------- |
| better-sqlite3 é¢„ç¼–è¯‘ | v16.20.0     | 103                 |
| ç³»ç»Ÿ Node.js          | v22.17.0     | 127                 |
| Electron 28 å†…ç½®      | v18.19.0     | 120                 |

ç”±äºç‰ˆæœ¬ä¸åŒ¹é…ï¼Œå¯¼è‡´ï¼š

- åœ¨æ™®é€š Node.js ç¯å¢ƒä¸­ï¼šæ— æ³•åŠ è½½æ¨¡å—
- åœ¨ Electron ç¯å¢ƒä¸­ï¼šå¯èƒ½åŠ è½½æ—§ç‰ˆæœ¬å¯¼è‡´ä¸ç¨³å®š

---

## âœ… è§£å†³æ–¹æ¡ˆéªŒè¯

### æµ‹è¯• 1ï¼šæ™®é€š Node.js ç¯å¢ƒ

```bash
node -e "const Database = require('better-sqlite3'); console.log('âœ… Loaded');"
```

**ç»“æœ**ï¼šâœ… æˆåŠŸåŠ è½½

### æµ‹è¯• 2ï¼šElectron ç¯å¢ƒ

```bash
# è¿è¡Œåº”ç”¨ï¼ŒæŸ¥çœ‹æ—¥å¿—
npm run dev
```

**ç»“æœ**ï¼š

```
[INFO] æ•°æ®åº“è¿æ¥å·²å»ºç«‹
[INFO] æ•°æ®åº“è¡¨åˆ›å»ºå®Œæˆ
[INFO] æ•°æ®åº“åˆå§‹åŒ–å®Œæˆ
```

âœ… å®Œå…¨æˆåŠŸ

---

## ğŸ¯ æœ€ç»ˆçŠ¶æ€

### å·²è§£å†³çš„é—®é¢˜

1. âœ… **better-sqlite3 ç¼–è¯‘é—®é¢˜**
   - å¼ºåˆ¶ä»æºä»£ç ç¼–è¯‘
   - ä½¿ç”¨æ­£ç¡®çš„ Electron 28 ç¯å¢ƒ

2. âœ… **æ•°æ®åº“åˆå§‹åŒ–å¤±è´¥**
   - ç°åœ¨å¯ä»¥æ­£å¸¸åˆ›å»ºå’Œè¿æ¥æ•°æ®åº“
   - æ‰€æœ‰è¡¨å’Œç´¢å¼•åˆ›å»ºæˆåŠŸ

3. âœ… **å‰ç«¯ loading é¡µé¢é—®é¢˜**
   - `isLoading` åˆå§‹å€¼æ”¹ä¸º `false`
   - App.tsx é€»è¾‘ä¿®å¤
   - ProtectedRoute æ¡ä»¶ä¼˜åŒ–

### å½“å‰ç³»ç»ŸçŠ¶æ€

- **æ•°æ®åº“è·¯å¾„**ï¼š`/Users/james/Library/Application Support/Electron/resumerhelper.db`
- **æ•°æ®åº“æ–‡ä»¶**ï¼šSQLite 3
- **è¡¨ç»“æ„**ï¼šusers, resumes, analyses, settings
- **ç´¢å¼•**ï¼šå·²åˆ›å»ºå¿…è¦çš„ç´¢å¼•

---

## ğŸš€ ä¸‹ä¸€æ­¥

### 1. å¯åŠ¨åº”ç”¨

```bash
npm run dev
```

### 2. éªŒè¯åŠŸèƒ½

æ‰“å¼€åº”ç”¨åï¼Œåº”è¯¥èƒ½çœ‹åˆ°ï¼š

- âœ… ç™»å½•é¡µé¢ï¼ˆä¸æ˜¯ loadingï¼‰
- âœ… å¯ä»¥æ³¨å†Œæ–°ç”¨æˆ·
- âœ… å¯ä»¥ä¸Šä¼ ç®€å†
- âœ… æ•°æ®åº“æ­£å¸¸å·¥ä½œ

### 3. æ¸…é™¤å‰ç«¯æ—§æ•°æ®ï¼ˆå¦‚æœéœ€è¦ï¼‰

å¦‚æœå‰ç«¯ä»ç„¶æ˜¾ç¤º loadingï¼Œæ‰“å¼€å¼€å‘è€…å·¥å…·ï¼ˆCmd+Option+Iï¼‰ï¼š

```javascript
localStorage.removeItem("auth-storage");
location.reload();
```

---

## ğŸ“ é‡è¦æç¤º

### Native æ¨¡å—ç¼–è¯‘

**ä¸ºä»€ä¹ˆéœ€è¦é‡æ–°ç¼–è¯‘ï¼Ÿ**

1. é¢„ç¼–è¯‘çš„äºŒè¿›åˆ¶æ–‡ä»¶ä¸åŒ¹é…å½“å‰ Node.js ç‰ˆæœ¬
2. Electron ä½¿ç”¨ä¸åŒç‰ˆæœ¬çš„ Node.js
3. æ¶æ„å·®å¼‚ï¼ˆx86_64 vs arm64ï¼‰

**ä»€ä¹ˆæ—¶å€™éœ€è¦é‡æ–°ç¼–è¯‘ï¼Ÿ**

- âœ… æ¯æ¬¡æ›´æ–° better-sqlite3 ç‰ˆæœ¬
- âœ… åˆ‡æ¢ Electron ç‰ˆæœ¬
- âœ… åœ¨ä¸åŒ Node.js ç‰ˆæœ¬ä¸‹å¼€å‘
- âœ… é‡æ–°å®‰è£… `node_modules`

### è‡ªåŠ¨åŒ–æ–¹æ¡ˆ

ç¡®ä¿ `package.json` ä¸­çš„ `postinstall` è„šæœ¬é…ç½®æ­£ç¡®ï¼š

```json
{
  "scripts": {
    "postinstall": "npm run electron-rebuild"
  }
}
```

è¿™æ ·æ¯æ¬¡è¿è¡Œ `npm install` åä¼šè‡ªåŠ¨é‡æ–°ç¼–è¯‘ native æ¨¡å—ã€‚

---

## ğŸ‰ æ€»ç»“

é€šè¿‡ä»¥ä¸‹æ­¥éª¤å®Œå…¨è§£å†³äº†æ•°æ®åº“åˆå§‹åŒ–é—®é¢˜ï¼š

1. **è¯†åˆ«é—®é¢˜**ï¼š`better-sqlite3` ABI ç‰ˆæœ¬ä¸åŒ¹é…
2. **æ¸…ç†ç¯å¢ƒ**ï¼šåˆ é™¤æ—§çš„ç¼–è¯‘äº§ç‰©
3. **å¼ºåˆ¶ç¼–è¯‘**ï¼šä»æºä»£ç é‡æ–°ç¼–è¯‘
4. **ç¯å¢ƒé…ç½®**ï¼šè®¾ç½®æ­£ç¡®çš„ Electron ç¯å¢ƒå˜é‡
5. **éªŒè¯ä¿®å¤**ï¼šæµ‹è¯• Node.js å’Œ Electron ç¯å¢ƒ

**ç°åœ¨ç³»ç»Ÿå¯ä»¥æ­£å¸¸è¿è¡Œï¼š**

- æ•°æ®åº“æ­£å¸¸åˆå§‹åŒ– âœ…
- æ‰€æœ‰æœåŠ¡æ­£å¸¸å¯åŠ¨ âœ…
- åº”ç”¨å¯ä»¥æ­£å¸¸ä½¿ç”¨ âœ…

### ç«‹å³å¯ç”¨

è¿è¡Œä»¥ä¸‹å‘½ä»¤å¯åŠ¨åº”ç”¨ï¼š

```bash
npm run dev
```

åº”ç”¨å°†è‡ªåŠ¨ï¼š

1. åˆå§‹åŒ–æ•°æ®åº“
2. å¯åŠ¨ Vite å¼€å‘æœåŠ¡å™¨ï¼ˆç«¯å£ 3000ï¼‰
3. å¯åŠ¨ KOA åç«¯æœåŠ¡å™¨ï¼ˆç«¯å£ 3001ï¼‰
4. æ‰“å¼€ Electron çª—å£

### æ•°æ®åº“æ–‡ä»¶ä½ç½®

```
/Users/james/Library/Application Support/Electron/resumerhelper.db
```

å¦‚æœéœ€è¦é‡ç½®æ•°æ®åº“ï¼Œåˆ é™¤æ­¤æ–‡ä»¶å³å¯ã€‚
